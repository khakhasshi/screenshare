# 跨平台虚拟屏幕共享 MVP

一个基于 Python 的最小可用验证（MVP）屏幕共享应用，支持 Windows/Mac 在局域网内共享屏幕。

## 功能特性

✓ **自动服务发现** - 使用 mDNS，自动检测局域网内的屏幕共享服务  
✓ 实时屏幕捕获和传输  
✓ 自适应 JPEG 压缩，减少带宽占用  
✓ 支持多客户端同时连接  
✓ 可配置的帧率和图像质量  
✓ 跨平台支持（Windows/Mac/Linux）  

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 自动发现模式（推荐）

#### 1. 启动服务器（主机）

在要共享屏幕的电脑上运行：

```bash
python server.py [port] [quality] [fps]
```

示例：
```bash
python server.py                    # 使用默认配置
python server.py 5000 70 15         # 自定义配置
```

#### 2. 启动客户端（接收端）

在接收屏幕的电脑上运行：

```bash
python client.py
```

客户端会自动扫描局域网并显示可用的屏幕共享服务，选择一个并点击"连接"即可。

---

### 手动连接模式

如果自动发现不工作，可以手动指定服务器地址：

```bash
python client.py <server_ip> [port]
```

示例：
```bash
python client.py 192.168.1.100          # 连接到指定 IP
python client.py 192.168.1.100 5000     # 指定 IP 和端口
```

## 获取服务器 IP 地址

### Mac 上查看 IP：
```bash
ifconfig | grep "inet " | grep -v 127.0.0.1
```

### Windows 上查看 IP：
```bash
ipconfig
```

## 性能建议

| 场景 | 质量 | 帧率 | 备注 |
|------|------|------|------|
| 低带宽（<5 Mbps） | 40-50 | 5-8 | 降低分辨率可进一步优化 |
| 中等带宽（5-20 Mbps） | 60-70 | 10-12 | 推荐配置 |
| 高带宽（>20 Mbps） | 75-85 | 15-20 | 更高质量的体验 |

## 架构说明
 架构说明

### 服务发现（discovery.py）
- 使用 mDNS (Multicast DNS) 协议
- 服务器启动时自动注册到局域网
- 客户端启动时自动扫描并列出可用服务
- 支持服务的实时上线/离线检测

### 服务器（server.py）
- 使用 PIL 捕获屏幕
- 将图像压缩为 JPEG 格式
- 通过 TCP Socket 广播给所有连接的客户端
- 支持多客户端同时连接

### 客户端（client.py）
- 使用 Tkinter 构建 GUI
- 内置服务发现，自动列出局域网内的服务
- 使用 Tkinter 构建 GUI
- 接收并解码 JPEG 数据
- 自动缩放以适应窗口
- 显示连接状态和帧信息

## 下一步改进方向

1. **视频编码优化**
   - 实现 H.264/H.265 视频编码
   - 仅发送帧间差异（增量编码）
   
2. **输入控制**
   - 支持远程鼠标和键盘控制
   
3. **网络优化**
   - UDP 传输以降低延迟
   - 自适应码率控制
   
4. **安全性**
   - 添加身份验证
   - 加密传输

5. **用户界面**
   - 服务器监控面板
   - 客户端连接管理
   - 实时统计面板

## 故障排除

**问题：客户端无法连接到服务器**
- 检查防火墙设置，确保端口 5000（或自定义端口）已开放
- 确认服务器 IP 地址正确（使用 ifconfig/ipconfig 查看）
- 确保在同一局域网内

**问题：屏幕显示卡顿**
- 降低分辨率（修改 server.py 中的缩放比例）
- 降低帧率和质量
- 检查网络延迟

**问题：延迟高**
- 使用有线连接而不是 WiFi
- 降低图像质量
- 增加帧率（同时降低质量以保持带宽）

## 许可证

MIT
